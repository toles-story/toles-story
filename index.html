<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Tôles-Story V2</title>
<link href="https://fonts.googleapis.com/css2?family=Luckiest+Guy&display=swap" rel="stylesheet" />
<style>
  body {
    font-family: Arial, sans-serif;
    background: linear-gradient(120deg, #3991e6 0%, #f7e35f 100%);
    margin: 0; min-height: 100vh; padding: 0;
  }
  .page {
    display: none;
    max-width: 440px;
    margin: 0 auto;
    padding: 20px 15px 40px 15px;
    background: #fff;
    border-radius: 16px;
    box-shadow: 0 6px 15px rgba(0,0,0,0.1);
  }
  .page.active {
    display: block;
  }
  .logo-container {
    text-align: center;
    margin: 25px 0 15px 0;
  }
  .logo-img {
    width: 110px;
    height: auto;
    margin: 0 auto 6px auto;
    display: block;
  }
  .logo-title {
    font-family: 'Luckiest Guy', cursive;
    font-size: 2.2rem;
    color: #fdd835;
    text-shadow: 2px 2px 0 #1976d2, -2px -2px 0 #1976d2,
                 2px -2px 0 #1976d2, -2px 2px 0 #1976d2;
    letter-spacing: 1.5px;
    line-height: 1;
    margin: 0;
  }
  label {
    display: block;
    margin-top: 12px;
    font-weight: 600;
    color: #1976d2;
  }
  input[type=number], select {
    width: 100%;
    padding: 8px 12px;
    margin-top: 6px;
    font-size: 1rem;
    border-radius: 6px;
    border: 1px solid #ccc;
    box-sizing: border-box;
  }
  .switch-label {
    margin-top: 15px;
    display: flex;
    align-items: center;
    gap: 12px;
    font-weight: 600;
    color: #1976d2;
  }
  .switch {
    position: relative;
    display: inline-block;
    width: 48px;
    height: 24px;
  }
  .switch input {
    opacity: 0;
    width: 0;
    height: 0;
  }
  .slider {
    position: absolute;
    cursor: pointer;
    top: 0; left: 0; right: 0; bottom: 0;
    background-color: #ccc;
    transition: .4s;
    border-radius: 24px;
  }
  .slider:before {
    position: absolute;
    content: "";
    height: 18px;
    width: 18px;
    left: 3px;
    bottom: 3px;
    background-color: white;
    transition: .4s;
    border-radius: 50%;
  }
  input:checked + .slider {
    background-color: #ffca2b;
  }
  input:checked + .slider:before {
    transform: translateX(24px);
  }
  .btn-row {
    display: flex;
    gap: 14px;
    margin-top: 28px;
    justify-content: center;
  }
  button {
    flex: 1;
    padding: 14px 0;
    font-family: 'Luckiest Guy', cursive;
    font-weight: bold;
    font-size: 1.1rem;
    border-radius: 34px;
    border: none;
    cursor: pointer;
    box-shadow: 0 4px 12px rgba(0,0,0,0.07);
    transition: background 0.2s;
  }
  button.calc-btn {
    background-color: #ffca2b;
    color: #1976d2;
  }
  button.calc-btn:active {
    background-color: #ffe066;
  }
  button.reset-btn {
    background-color: #e0e0e0;
    color: #333;
  }
  button.reset-btn:active {
    background-color: #c7c7c7;
  }
  button.manual-btn {
    background-color: #fff;
    color: #1976d2;
    border: 2px solid #1976d2;
  }
  button.manual-btn:active {
    background-color: #d0e4ff;
  }
  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 24px;
  }
  th, td {
    border: 1px solid #ddd;
    padding: 10px 8px;
    text-align: left;
  }
  th {
    background-color: #ffca2b;
    color: #1976d2;
    font-weight: 700;
  }
  .svg-container {
    margin-top: 25px;
    text-align: center;
  }
  svg {
    max-width: 100%;
    height: auto;
  }
</style>
</head>
<body>

<!-- Page Dimensions & Options -->
<div id="page-dimensions" class="page active">
  <div class="logo-container">
    <img src="assets/logo-toles-story.png" alt="Logo Tôles-Story" class="logo-img" />
    <div class="logo-title">TÔLES-STORY</div>
  </div>
  <label for="longueur">Longueur (L) mm</label>
  <input type="number" id="longueur" min="1" value="600" />
  <label for="largeur">Largeur (l) mm</label>
  <input type="number" id="largeur" min="1" value="400" />
  <label for="hauteur">Hauteur (h) mm</label>
  <input type="number" id="hauteur" min="0" value="300" />
  <label for="epaisseur">Épaisseur de tôle (mm)</label>
  <input type="number" id="epaisseur" min="0.1" step="0.1" value="3" />
  <label for="retour">Retour (K-factor) mm</label>
  <input type="number" id="retour" min="0" step="0.1" value="0" />

  <label for="matiere">Matière</label>
  <select id="matiere">
    <option value="alu">Aluminium</option>
    <option value="inox">Inox</option>
    <option value="acier">Acier</option>
  </select>

  <div class="switch-label">
    Type de fabrication (plié / soudé quart à quart)
    <label class="switch">
      <input type="checkbox" id="fabrication" checked />
      <span class="slider"></span>
    </label>
  </div>

  <div class="switch-label">
    Possède une plieuse ?
    <label class="switch">
      <input type="checkbox" id="plieuse" checked />
      <span class="slider"></span>
    </label>
  </div>

  <div class="switch-label">
    Autoriser les encoches ?
    <label class="switch">
      <input type="checkbox" id="encoches" checked />
      <span class="slider"></span>
    </label>
  </div>

  <label for="type-encoche">Type d'encoche</label>
  <select id="type-encoche">
    <option value="v90">V 90°</option>
    <option value="u">U</option>
    <option value="autre">Autre</option>
  </select>

  <div class="btn-row">
    <button class="calc-btn" onclick="calculer()">Calculer</button>
    <button class="reset-btn" onclick="recommencer()">Recommencer</button>
  </div>
  <button class="manual-btn" onclick="modifierManuellement()">Modifier manuellement</button>
</div>

<!-- Page Résultat -->
<div id="page-resultat" class="page">
  <div class="logo-container">
    <img src="assets/logo-toles-story.png" alt="Logo Tôles-Story" class="logo-img" />
    <div class="logo-title">TÔLES-STORY</div>
  </div>

  <h2>Résultat du développé</h2>
  <table id="result-table">
    <thead>
      <tr>
        <th>Pièce</th>
        <th>Dimensions (mm)</th>
        <th>Matière</th>
        <th>Épaisseur</th>
        <th>Type de pli</th>
        <th>Qté</th>
        <th>Poids (kg/u)</th>
      </tr>
    </thead>
    <tbody>
      <!-- Rempli par JS -->
    </tbody>
  </table>

  <div class="svg-container">
    <svg id="svg-developpe" width="300" height="200" viewBox="0 0 300 200" xmlns="http://www.w3.org/2000/svg">
      <rect x="10" y="10" width="100" height="100" fill="#ffca2b" stroke="#1976d2" stroke-width="3" />
      <!-- Exemples de dessin -->
    </svg>
  </div>

  <div class="btn-row" style="margin-top:25px;">
    <button class="calc-btn" onclick="retourPage()">Retour</button>
    <button class="reset-btn" onclick="recommencer()">Nouvelle pièce</button>
  </div>
</div>

<script>
  // Gestion des pages
  function showPage(id) {
    document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
    document.getElementById(id).classList.add('active');
  }

  // Reset des champs
  function recommencer() {
    showPage('page-dimensions');
    document.getElementById('longueur').value = 600;
    document.getElementById('largeur').value = 400;
    document.getElementById('hauteur').value = 300;
    document.getElementById('epaisseur').value = 3;
    document.getElementById('retour').value = 0;
    document.getElementById('matiere').value = 'alu';
    document.getElementById('fabrication').checked = true;
    document.getElementById('plieuse').checked = true;
    document.getElementById('encoches').checked = true;
    document.getElementById('type-encoche').value = 'v90';
    clearResult();
  }

  // Nettoyer tableau résultats
  function clearResult() {
    const tbody = document.querySelector('#result-table tbody');
    tbody.innerHTML = '';
    const svg = document.getElementById('svg-developpe');
    while (svg.lastChild) {
      svg.removeChild(svg.lastChild);
    }
  }

  // Calcul simplifié (à affiner avec vrais formules)
  function calculer() {
    const L = parseFloat(document.getElementById('longueur').value);
    const l = parseFloat(document.getElementById('largeur').value);
    const h = parseFloat(document.getElementById('hauteur').value);
    const e = parseFloat(document.getElementById('epaisseur').value);
    const retour = parseFloat(document.getElementById('retour').value);
    const matiere = document.getElementById('matiere').value;
    const fabrication = document.getElementById('fabrication').checked ? 'Plié' : 'Soudé quart à quart';
    const plieuse = document.getElementById('plieuse').checked;
    const encoches = document.getElementById('encoches').checked;
    const typeEncoche = document.getElementById('type-encoche').value;

    // Calcul du développé simple pour caisson U (exemple)
    // On soustrait retour au développé
    const developpe = (L + 2 * h) * (l + 2 * h) - retour;

    // Exemple de découpe des pièces
    const pieces = [
      { nom: 'Fond', dim: `${L} x ${l}`, mat: matiere, epaisseur: e + ' mm', pli: 'Plat', qte: 1, poids: (L*l*e*0.0027).toFixed(2) },
      { nom: 'Côté droit', dim: `${h} x ${l}`, mat: matiere, epaisseur: e + ' mm', pli: 'Pli U', qte: 2, poids: (h*l*e*0.0027).toFixed(2) },
      { nom: 'Côté gauche', dim: `${h} x ${l}`, mat: matiere, epaisseur: e + ' mm', pli: 'Pli U', qte: 2, poids: (h*l*e*0.0027).toFixed(2) },
    ];

    // Affichage résultats
    const tbody = document.querySelector('#result-table tbody');
    tbody.innerHTML = '';
    pieces.forEach(p => {
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>${p.nom}</td>
        <td>${p.dim}</td>
        <td>${p.mat}</td>
        <td>${p.epaisseur}</td>
        <td>${p.pli}</td>
        <td>${p.qte}</td>
        <td>${p.poids}</td>
      `;
      tbody.appendChild(tr);
    });

    // Exemple dessin SVG simple (rectangle fond)
    clearSVG();
    const svg = document.getElementById('svg-developpe');
    const rect = document.createElementNS("http://www.w3.org/2000/svg", "rect");
    rect.setAttribute("x", "20");
    rect.setAttribute("y", "20");
    rect.setAttribute("width", 260);
    rect.setAttribute("height", 160);
    rect.setAttribute("fill", "#ffca2b");
    rect.setAttribute("stroke", "#1976d2");
    rect.setAttribute("stroke-width", "4");
    svg.appendChild(rect);

    showPage('page-resultat');
  }

  function clearSVG() {
    const svg = document.getElementById('svg-developpe');
    while (svg.lastChild) {
      svg.removeChild(svg.lastChild);
    }
  }

  function modifierManuellement() {
    alert('Cette fonction sera ajoutée dans une prochaine version.');
  }

  function retourPage() {
    showPage('page-dimensions');
  }

  // Initialisation
  recommencer();
</script>

</body>
</html>
